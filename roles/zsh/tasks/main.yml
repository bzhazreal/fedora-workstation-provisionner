---
- name: Install zsh
  dnf:
    name: zsh
    state: latest

- name: Clone oh-my-zsh repo
  git:
    repo: https://github.com/robbyrussell/oh-my-zsh.git
    dest: "/home/{{ username }}/.oh-my-zsh"

- name: Clone zsh-autosuggestions repo
  git:
    repo: https://github.com/zsh-users/zsh-autosuggestions
    dest: "/home/{{ username }}/.oh-my-zsh/custom/plugins/zsh-autosuggestions"

- name: Update .oh-my-zsh owner.
  file:
    path: /home/{{ username }}/.oh-my-zsh
    owner: "{{ username }}"
    group: "{{ username }}"
    recurse: yes

- name: Adding .zshrc file
  template:
    src: ../templates/zshrc.j2
    dest: "/home/{{ username }}/.zshrc"
    owner: "{{ username }}"
    group: "{{ username }}"
    mode: 0644

- name: Set zsh as default shell
  user:
    name: "{{ username }}"
    shell: /bin/zsh
